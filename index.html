<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centre de recherche en environnement - Système de réservation de laboratoires</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            color: #333;
            background-color: #bbdefb;
            margin-top: 100px;
        }
        .container {
            width: 80%;
            margin: auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-align: left;
        }
        h1 {
            color: #004d40;
            font-size: 2.5em;
            margin-top: 50px;
            text-align: center;
            position: relative;
        }
        h2 {
            color: #00695c;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h3 {
            color: #333;
            margin-top: 30px;
            font-size: 1.5em;
        }
        .cre-text {
            color: #4CAF50;
            font-weight: bold;
            font-family: 'Times New Roman', Times, serif;
            font-size: 1.2em;
        }
        ul {
            list-style-type: none;
            padding: 0;
        }
        li {
            background-color: #e8f5e9;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 1.1em;
            cursor: pointer;
        }
        li:hover {
            background-color: #dcedc8;
        }
        li a {
            text-decoration: none;
            color: #00695c;
            font-weight: bold;
            display: block;
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .lab-details p {
            line-height: 1.6;
            color: #666;
        }
        form {
            text-align: left;
            margin-top: 30px;
        }
        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
            color: #555;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }
        textarea {
            resize: vertical;
        }
        .form-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        .form-buttons button, .form-buttons a {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.2em;
            margin: 0 5px;
            text-decoration: none;
            text-align: center;
            transition: background-color 0.3s ease;
        }
        .submit-btn {
            background-color: #004d40;
            color: white;
        }
        .submit-btn:hover {
            background-color: #00332c;
        }
        .download-btn {
            background-color: #1976D2;
            color: white;
        }
        .download-btn:hover {
            background-color: #1565C0;
        }
        .back-btn {
            background-color: #6c757d;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }
        .back-btn:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>

    <button class="back-btn" onclick="showSection('main-menu')">Retour au menu principal</button>

    <h1>Centre de recherche en environnement <span class="cre-text">CRE</span></h1>

    <div class="container">
        <div id="main-menu" class="section active">
            <h2>Liste des laboratoires et de l'atelier d'électronique</h2>
            <ul>
                <li onclick="showSection('lab-1')">Laboratoire physico-chimique</li>
                <li onclick="showSection('lab-2')">Laboratoire de surveillance environnementale</li>
                <li onclick="showSection('lab-3')">Laboratoire microbiologique</li>
                <li onclick="showSection('lab-4')">Laboratoire de cyto-toxicologie</li>
                <li onclick="showSection('electronics-workshop')">Atelier d'électronique</li>
            </ul>
        </div>
        
        <div id="lab-1" class="section">
            <hr>
            <h2>Laboratoire physico-chimique</h2>
            <div class="lab-details">
                <h3>Présentation du laboratoire</h3>
                <p>Ce laboratoire se spécialise dans les analyses physiques et chimiques des sols, des eaux et de l'air. Il est équipé d'appareils sophistiqués pour mesurer le pH, la salinité, les polluants et les métaux lourds.</p>
                <h3>Équipements et instruments</h3>
                <ul>
                    <li>pH-mètre</li>
                    <li>Salinimètre</li>
                    <li>Appareil de chromatographie</li>
                    <li>Appareils de mesure des métaux lourds</li>
                </ul>
            </div>
            <hr>
            <h2>Formulaire de demande de réservation</h2>
            <form id="form-lab-1" onsubmit="sendEmail(event, 'form-lab-1')">
                <label for="demande_par-1">Demande établie par:</label>
                <input type="text" id="demande_par-1" name="demande_par" required>
                <label for="email-1">E-mail:</label>
                <input type="email" id="email-1" name="email" required>
                <label for="equipement-1">Equipement:</label>
                <input type="text" id="equipement-1" name="equipement">
                <label for="date-1">Date de réservation:</label>
                <input type="date" id="date-1" name="date" required>
                <label for="division-1">La division:</label>
                <select id="division-1" name="division">
                    <option value="Environnement et Biodiversité">Environnement et Biodiversité</option>
                    <option value="Environnement et Santé">Environnement et Santé</option>
                    <option value="Environnement, Modélisation et Changements Climatiques">Environnement, Modélisation et Changements Climatiques</option>
                    <option value="Environnement et Eco-gestion des Déchets">Environnement et Eco-gestion des Déchets</option>
                </select>
                <label for="lab_de-1">Laboratoire de:</label>
                <select id="lab_de-1" name="lab_de">
                    <option value="Laboratoire physico-chimique">Laboratoire physico-chimique</option>
                    <option value="Laboratoire de surveillance environnementale">Laboratoire de surveillance environnementale</option>
                    <option value="Laboratoire microbiologique">Laboratoire microbiologique</option>
                    <option value="Laboratoire de cyto-toxicologie">Laboratoire de cyto-toxicologie</option>
                    <option value="Atelier d'électronique">Atelier d'électronique</option>
                </select>
                <label for="objet_demande_travail-1">Objet de la demande de travail:</label>
                <textarea id="objet_demande_travail-1" name="objet_demande_travail" rows="5" required></textarea>
                <div class="form-buttons">
                    <button type="submit" class="submit-btn">Envoyer la demande de réservation</button>
                    <button type="button" onclick="generatePDF('form-lab-1')" class="download-btn">Télécharger le formulaire PDF</button>
                </div>
            </form>
        </div>

        <div id="lab-2" class="section">
            <hr>
            <h2>Laboratoire de surveillance environnementale</h2>
            <div class="lab-details">
                <h3>Présentation du laboratoire</h3>
                <p>Ce laboratoire est dédié à la surveillance et à l'évaluation de la qualité de l'environnement, y compris l'air, l'eau et le sol. Il utilise des équipements de pointe pour la détection et l'analyse des polluants environnementaux.</p>
                <h3>Équipements et instruments</h3>
                <ul>
                    <li>Analyseurs de gaz</li>
                    <li>Systèmes de surveillance de la qualité de l'eau</li>
                    <li>Appareils de mesure de la pollution sonore</li>
                </ul>
            </div>
            <hr>
            <h2>Formulaire de demande de réservation</h2>
            <form id="form-lab-2" onsubmit="sendEmail(event, 'form-lab-2')">
                <label for="demande_par-2">Demande établie par:</label>
                <input type="text" id="demande_par-2" name="demande_par" required>
                <label for="email-2">E-mail:</label>
                <input type="email" id="email-2" name="email" required>
                <label for="equipement-2">Equipement:</label>
                <input type="text" id="equipement-2" name="equipement">
                <label for="date-2">Date de réservation:</label>
                <input type="date" id="date-2" name="date" required>
                <label for="division-2">La division:</label>
                <select id="division-2" name="division">
                    <option value="Environnement et Biodiversité">Environnement et Biodiversité</option>
                    <option value="Environnement et Santé">Environnement et Santé</option>
                    <option value="Environnement, Modélisation et Changements Climatiques">Environnement, Modélisation et Changements Climatiques</option>
                    <option value="Environnement et Eco-gestion des Déchets">Environnement et Eco-gestion des Déchets</option>
                </select>
                <label for="lab_de-2">Laboratoire de:</label>
                <select id="lab_de-2" name="lab_de">
                    <option value="Laboratoire physico-chimique">Laboratoire physico-chimique</option>
                    <option value="Laboratoire de surveillance environnementale">Laboratoire de surveillance environnementale</option>
                    <option value="Laboratoire microbiologique">Laboratoire microbiologique</option>
                    <option value="Laboratoire de cyto-toxicologie">Laboratoire de cyto-toxicologie</option>
                    <option value="Atelier d'électronique">Atelier d'électronique</option>
                </select>
                <label for="objet_demande_travail-2">Objet de la demande de travail:</label>
                <textarea id="objet_demande_travail-2" name="objet_demande_travail" rows="5" required></textarea>
                <div class="form-buttons">
                    <button type="submit" class="submit-btn">Envoyer la demande de réservation</button>
                    <button type="button" onclick="generatePDF('form-lab-2')" class="download-btn">Télécharger le formulaire PDF</button>
                </div>
            </form>
        </div>

        <div id="lab-3" class="section">
            <hr>
            <h2>Laboratoire microbiologique</h2>
            <div class="lab-details">
                <h3>Présentation du laboratoire</h3>
                <p>Ce laboratoire se concentre sur l'étude des micro-organismes et de leur rôle dans les écosystèmes. Il est équipé للـ pour l'analyse des bactéries, des champignons et des virus dans les échantillons environnementaux.</p>
                <h3>Équipements et instruments</h3>
                <ul>
                    <li>Microscopes optiques et électroniques</li>
                    <li>Incubateurs</li>
                    <li>Matériel de culture microbienne</li>
                </ul>
            </div>
            <hr>
            <h2>Formulaire de demande de réservation</h2>
            <form id="form-lab-3" onsubmit="sendEmail(event, 'form-lab-3')">
                <label for="demande_par-3">Demande établie par:</label>
                <input type="text" id="demande_par-3" name="demande_par" required>
                <label for="email-3">E-mail:</label>
                <input type="email" id="email-3" name="email" required>
                <label for="equipement-3">Equipement:</label>
                <input type="text" id="equipement-3" name="equipement">
                <label for="date-3">Date de réservation:</label>
                <input type="date" id="date-3" name="date" required>
                <label for="division-3">La division:</label>
                <select id="division-3" name="division">
                    <option value="Environnement et Biodiversité">Environnement et Biodiversité</option>
                    <option value="Environnement et Santé">Environnement et Santé</option>
                    <option value="Environnement, Modélisation et Changements Climatiques">Environnement, Modélisation et Changements Climatiques</option>
                    <option value="Environnement et Eco-gestion des Déchets">Environnement et Eco-gestion des Déchets</option>
                </select>
                <label for="lab_de-3">Laboratoire de:</label>
                <select id="lab_de-3" name="lab_de">
                    <option value="Laboratoire physico-chimique">Laboratoire physico-chimique</option>
                    <option value="Laboratoire de surveillance environnementale">Laboratoire de surveillance environnementale</option>
                    <option value="Laboratoire microbiologique">Laboratoire microbiologique</option>
                    <option value="Laboratoire de cyto-toxicologie">Laboratoire de cyto-toxicologie</option>
                    <option value="Atelier d'électronique">Atelier d'électronique</option>
                </select>
                <label for="objet_demande_travail-3">Objet de la demande de travail:</label>
                <textarea id="objet_demande_travail-3" name="objet_demande_travail" rows="5" required></textarea>
                <div class="form-buttons">
                    <button type="submit" class="submit-btn">Envoyer la demande de réservation</button>
                    <button type="button" onclick="generatePDF('form-lab-3')" class="download-btn">Télécharger le formulaire PDF</button>
                </div>
            </form>
        </div>

        <div id="lab-4" class="section">
            <hr>
            <h2>Laboratoire de cyto-toxicologie</h2>
            <div class="lab-details">
                <h3>Présentation du laboratoire</h3>
                <p>Ce laboratoire est spécialisé dans l'étude des effets des substances toxiques sur les cellules vivantes. Il utilise des techniques avancées pour évaluer la toxicité des produits chimiques et des polluants environnementaux.</p>
                <h3>Équipements et instruments</h3>
                <ul>
                    <li>Cytomètres en flux</li>
                    <li>Microscopes à fluorescence</li>
                    <li>Équipements de culture cellulaire</li>
                </ul>
            </div>
            <hr>
            <h2>Formulaire de demande de réservation</h2>
            <form id="form-lab-4" onsubmit="sendEmail(event, 'form-lab-4')">
                <label for="demande_par-4">Demande établie par:</label>
                <input type="text" id="demande_par-4" name="demande_par" required>
                <label for="email-4">E-mail:</label>
                <input type="email" id="email-4" name="email" required>
                <label for="equipement-4">Equipement:</label>
                <input type="text" id="equipement-4" name="equipement">
                <label for="date-4">Date de réservation:</label>
                <input type="date" id="date-4" name="date" required>
                <label for="division-4">La division:</label>
                <select id="division-4" name="division">
                    <option value="Environnement et Biodiversité">Environnement et Biodiversité</option>
                    <option value="Environnement et Santé">Environnement et Santé</option>
                    <option value="Environnement, Modélisation et Changements Climatiques">Environnement, Modélisation et Changements Climatiques</option>
                    <option value="Environnement et Eco-gestion des Déchets">Environnement et Eco-gestion des Déchets</option>
                </select>
                <label for="lab_de-4">Laboratoire de:</label>
                <select id="lab_de-4" name="lab_de">
                    <option value="Laboratoire physico-chimique">Laboratoire physico-chimique</option>
                    <option value="Laboratoire de surveillance environnementale">Laboratoire de surveillance environnementale</option>
                    <option value="Laboratoire microbiologique">Laboratoire microbiologique</option>
                    <option value="Laboratoire de cyto-toxicologie">Laboratoire de cyto-toxicologie</option>
                    <option value="Atelier d'électronique">Atelier d'électronique</option>
                </select>
                <label for="objet_demande_travail-4">Objet de la demande de travail:</label>
                <textarea id="objet_demande_travail-4" name="objet_demande_travail" rows="5" required></textarea>
                <div class="form-buttons">
                    <button type="submit" class="submit-btn">Envoyer la demande de réservation</button>
                    <button type="button" onclick="generatePDF('form-lab-4')" class="download-btn">Télécharger le formulaire PDF</button>
                </div>
            </form>
        </div>

        <div id="electronics-workshop" class="section">
            <hr>
            <h2>Atelier d'électronique</h2>
            <div class="lab-details">
                <h3>Présentation de l'atelier</h3>
                <p>Cet atelier fournit les outils et équipements nécessaires pour la conception, la fabrication et la maintenance des appareils électroniques utilisés dans la recherche. Il comprend des équipements de soudure, des appareils de mesure numériques et des kits de prototypage pour les circuits électroniques.</p>
                <h3>Équipements et instruments</h3>
                <ul>
                    <li>Équipements de soudure électronique</li>
                    <li>Multimètres numériques</li>
                    <li>Outils de test de circuits électroniques</li>
                </ul>
            </div>
            <hr>
            <h2>Formulaire de demande de réservation</h2>
            <form id="form-electronics" onsubmit="sendEmail(event, 'form-electronics')">
                <label for="demande_par-5">Demande établie par:</label>
                <input type="text" id="demande_par-5" name="demande_par" required>
                <label for="email-5">E-mail:</label>
                <input type="email" id="email-5" name="email" required>
                <label for="equipement-5">Equipement:</label>
                <input type="text" id="equipement-5" name="equipement">
                <label for="date-5">Date de réservation:</label>
                <input type="date" id="date-5" name="date" required>
                <label for="division-5">La division:</label>
                <select id="division-5" name="division">
                    <option value="Environnement et Biodiversité">Environnement et Biodiversité</option>
                    <option value="Environnement et Santé">Environnement et Santé</option>
                    <option value="Environnement, Modélisation et Changements Climatiques">Environnement, Modélisation et Changements Climatiques</option>
                    <option value="Environnement et Eco-gestion des Déchets">Environnement et Eco-gestion des Déchets</option>
                </select>
                <label for="lab_de-5">Laboratoire de:</label>
                <select id="lab_de-5" name="lab_de">
                    <option value="Laboratoire physico-chimique">Laboratoire physico-chimique</option>
                    <option value="Laboratoire de surveillance environnementale">Laboratoire de surveillance environnementale</option>
                    <option value="Laboratoire microbiologique">Laboratoire microbiologique</option>
                    <option value="Laboratoire de cyto-toxicologie">Laboratoire de cyto-toxicologie</option>
                    <option value="Atelier d'électronique">Atelier d'électronique</option>
                </select>
                <label for="objet_demande_travail-5">Objet de la demande de travail:</label>
                <textarea id="objet_demande_travail-5" name="objet_demande_travail" rows="5" required></textarea>
                <div class="form-buttons">
                    <button type="submit" class="submit-btn">Envoyer la demande de réservation</button>
                    <button type="button" onclick="generatePDF('form-electronics')" class="download-btn">Télécharger le formulaire PDF</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@3.8.1/dist/jspdf.plugin.autotable.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init('QDMvJKgB1WdswKl2R');
        })();

        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }

        function sendEmail(event, formId) {
            event.preventDefault();
            const form = document.getElementById(formId);

            emailjs.sendForm('service', 'template_lzc9jl5', form)
                .then(() => {
                    alert('Demande de réservation envoyée avec succès !');
                    form.reset();
                }, (error) => {
                    alert('Échec de l\'envoi de la demande. Veuillez réessayer.');
                    console.log('ÉCHEC...', error);
                });
        }
        
        function generatePDF(formId) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const form = document.getElementById(formId);
            const formData = new FormData(form);

            // تحضير البيانات للجدول
            const tableRows = [];
            const dataMapping = {
                'demande_par': 'Demandeur',
                'email': 'E-mail',
                'equipement': 'Équipement',
                'date': 'Date de réservation',
                'division': 'Division',
                'lab_de': 'Laboratoire',
                'objet_demande_travail': 'Objet de la demande'
            };

            for (let pair of formData.entries()) {
                const [key, value] = pair;
                if (dataMapping[key]) {
                    tableRows.push([dataMapping[key], value]);
                }
            }

            // إضافة عنوان PDF الجديد
            doc.setFontSize(18);
            doc.text("Demande de travail", 14, 20);

            // إضافة الجدول بدون رؤوس الأعمدة
            doc.autoTable({
                startY: 30,
                head: [],
                body: tableRows,
            });

            // إضافة قسم التوقيعات
            const finalY = doc.autoTable.previous.finalY + 20;
            const pageWidth = doc.internal.pageSize.getWidth();
            const padding = 20;
            
            doc.setFontSize(12);
            doc.text("Directeur de division", padding, finalY);
            doc.text("L’intéressé(e)", pageWidth - padding - doc.getTextWidth("L’intéressé(e)"), finalY);
            
            doc.save("Demande_de_travail.pdf");
        }
    </script>

</body>
</html>
